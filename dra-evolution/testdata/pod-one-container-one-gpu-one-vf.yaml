# A Pod asking for a Foozer GPU and an SR-IOV VF on the
# same pcie-root complex.
#
# NOTE: we probably could combine the two `devices` entries into
# one, since netdev doesn't get added to any container, it would
# just be ignored for that purpose.

apiVersion: resource.k8s.io/v1alpha2
kind: ResourceClaimTemplate
metadata:
  name: foozer-plus-vf
  namespace: default
spec:
  spec:
    requirements:
    - match:
        attribute: pcie-root.dra.k8s.io
    requests:
    - classes:
      - name: example.com-foozer
    - classes:
      - name: example.org-sriov-nic
      requirements:
      - device:
          selector: "device.stringAttributes['sriovType.example.org-sriov-nic'] == 'vf'"
---
apiVersion: resource.k8s.io/v1alpha2
kind: Pod
metadata:
  name: foozer
  namespace: default
spec:
  containers:
  - image: registry.k8s.io/pause:3.6
    name: my-container
    resources:
      requests:
        cpu: 10m
        memory: 10Mi
      claims:
      - name: gpu-and-nic
  resourceClaims:
  - name: gpu-and-nic
    source:
      resourceClaimTemplateName: template-foozer-plus-vf
